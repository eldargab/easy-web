#!/usr/bin/env bash

bench() {
  wrk -t4 -c20 -d5s http://127.0.0.1:8000$1 \
    | grep "Requests/sec" \
    | cut -d ':' -f 2 \
    | xargs echo "${@:2}:"
}

with() {
  node ./bench/$1 &
  local pid=$!
  sleep .5
  $2
  kill $pid
  wait $pid 2>/dev/null
}

echo
echo Hello world servers
echo

with easy-web.js "bench / EasyWeb"
with node.js "bench / Node.js"
with koa.js "bench / Koa"

echo
